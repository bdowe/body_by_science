{% extends "base.html" %}
{% block content %}
<h4 class="error hidden"></h4>
<div class="contact">
    <div class="flex-row">
        <div class="overlay hidden"></div>
        <div class="flex-column contact-info">
            <h2>Joshua D'Allesandro</h2>
            <div class="contact-subtext">joshd@gmail.com</div>
            <div class="contact-subtext">(123) 456-7890</div>
        </div>
        <div class="flex-column contact-form">
            <h2>Have questions or requests, just ask!</h2>
            <form id="contact-form">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" class="form-control" name="name">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="text" id="email" class="form-control" name="email">
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" class="form-control" name="message"></textarea>
                </div>
                <div class="btn btn-success">Send</div>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function() {
        $('.btn').click(function(e) {
            e.preventDefault();
            $('.error').addClass('hidden');
            $('.error').text('');
            $.ajax({
                url: '{{ url_for("submitContactForm") }}',
                data: $('form').serialize(),
                type: 'POST',
                beforeSend: function() {
                    $('.overlay').removeClass('hidden');
                },
                success: function(response) {
                    if (response.status === 'OK') {
                        window.location.href = "{{ url_for('users.profile') }}";
                    } else {
                        $('.error').removeClass('hidden');
                        $('.error').text('Could not send email');
                    }
                },
                error: function(error) {
                    $('.error').removeClass('hidden');
                    $('.error').text(error);
                },
                complete: function() {
                    $('.overlay').addClass('hidden');
                }
            });
        });
    });
</script>
{% endblock %}